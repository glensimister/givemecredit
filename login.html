<!DOCTYPE html>
<html lang="en">

<head>
    <title>DEVOLUTION</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/buttons.css">
    <link rel="stylesheet" href="css/left.css">
    <link rel="stylesheet" href="css/grid.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/select2.min.css">
    <!--<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">-->
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="js/vendor/select2.full.min.js"></script>
    <script src="/js/vendor/gun.js"></script>
    <script src="/js/vendor/sea.js"></script>
    <!--<script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>-->
    <!--<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>-->

    <style>
        #register {
            margin: 30px auto;
            max-width: 600px;
            width: 100%;
            -webkit-box-shadow: 3px 3px 13px 3px rgba(0, 0, 0, 0.33);
            -moz-box-shadow: 3px 3px 13px 3px rgba(0, 0, 0, 0.33);
            box-shadow: 3px 3px 13px 3px rgba(0, 0, 0, 0.33);
            border: 1px solid #eee;
            padding: 20px;
            background-color: #fff;
            border-radius: 4px;
        }
        
        .grid-2-col > div {
            border: 1px solid #eee;
            padding: 20px;
            border-radius: 4px;
        }
        /*.login {
            display: none;
        }*/

    </style>

    <script>
        document.write("<base href='" + window.location.href + "' />");
        $(document).ready(function() {

            $('.user-name').val('bob123');
            $('.password').val('password');
            $('.name').val('Bob Smith');

            var gun = Gun();
            var user = gun.user();
            $('.create-user').on("click", function(e) {
                e.stopImmediatePropagation();
                var name = $('.user-name').val();
                var password = $('.password').val();

                user.create(name, password, function(result) {
                    console.log(result.pub);
                    var pubKey = result.pub;
                    gun.get('users').put({
                        pubKey: pubKey
                    });
                });
                //$('.login').show();
                 //$('.register').hide();
                var username = $('.user-name').val();
                var password = $('.password').val();
                $('.user-name-login').val(username);
                $('.password-login').val(password);
            });
            $('.user-login').on("click", function(e) {
                e.stopImmediatePropagation();
                var username = $('.user-name-login').val();
                var password = $('.password-login').val();
                var name = $('.name').val();
                var photo = $('.photo').val();

                photo = photo.replace(/.*[\/\\]/, '');
                user.auth(username, password, function(result) {
                    var pubKey = result.pub;
                    var id = pubKey.substring(0, 8);
                    gun.get('pub/' + result.sea.pub).put({
                        id: id,
                        name: name,
                        photo: 'img/' + photo,
                        voteWeight: 0,
                        educationScore: 0,
                        socialRating: 0,
                        age: 0,
                        connections: 0,
                        likes: 0,
                        dislikes: 0,
                        about: "Hello! My name is " + name + "."
                    });
                    window.location.replace("index.html");
                })
            });
            $('.clear-storage').on("click", function(e) {
                localStorage.clear();
            });
        });

    </script>
</head>

<body>
    <div id="register">
        <div class="logo" style="padding:10px; border-radius: 5px;"><a><b><span>D</span>EVOLUTION</b></a></div>
        <br />
        <div class="grid-2-col">
            <div class="register">
                <h4 style="text-align: center">REGISTER</h4>
                <div class="form-group">
                    <label for="">User name:</label>
                    <input type="text" class="form-control user-name">
                </div>
                <div class="form-group">
                    <label for="">Password:</label>
                    <input type="password" class="form-control password">
                </div>
                <div class="form-group">
                    <label for="">Name:</label>
                    <input type="text" class="form-control name">
                </div>
                <div class="form-group">
                    <label for="">Profile Photo:</label>
                    <input type="file" name="pic" accept="img/*" class="photo">
                </div>
                <button type="submit" class="btn btn-blue create-user">REGISTER</button>
                <!-- <button type="submit" class="btn btn-blue clear-storage">CLEAR STORAGE</button>-->
            </div>
            <div class="login">
                <h4 style="text-align: center">LOGIN</h4>
                <div class="form-group">
                    <label for="">User name:</label>
                    <input type="text" class="form-control user-name-login">
                </div>
                <div class="form-group">
                    <label for="">Password:</label>
                    <input type="password" class="form-control password-login">
                </div>
                <button type="submit" class="btn btn-red user-login">LOGIN</button>
            </div>
        </div>
    </div>
</body>

</html>
